<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TMC Approval State Map</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700&family=IBM+Plex+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    :root {
      --bg-primary: #0a0a0b;
      --bg-secondary: #111113;
      --bg-tertiary: #18181b;
      --bg-card: #1c1c1f;
      --border: #2a2a2e;
      --border-hover: #3a3a3e;
      --text-primary: #fafafa;
      --text-secondary: #a1a1aa;
      --text-muted: #71717a;
      --accent-green: #22c55e;
      --accent-green-dim: rgba(34, 197, 94, 0.15);
      --accent-yellow: #eab308;
      --accent-yellow-dim: rgba(234, 179, 8, 0.15);
      --accent-red: #ef4444;
      --accent-red-dim: rgba(239, 68, 68, 0.15);
      --accent-blue: #3b82f6;
      --accent-blue-dim: rgba(59, 130, 246, 0.15);
      --accent-gray: #52525b;
      --accent-gray-dim: rgba(82, 82, 91, 0.15);
      --font-mono: 'JetBrains Mono', monospace;
      --font-sans: 'IBM Plex Sans', sans-serif;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: var(--font-sans);
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
    }

    #root {
      min-height: 100vh;
    }

    /* Scrollbar styling */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }

    ::-webkit-scrollbar-track {
      background: var(--bg-secondary);
    }

    ::-webkit-scrollbar-thumb {
      background: var(--border);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: var(--border-hover);
    }

    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }

    @keyframes slideIn {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .animate-fade-in {
      animation: fadeIn 0.5s ease-out forwards;
    }

    .animate-pulse {
      animation: pulse 2s ease-in-out infinite;
    }

    .animate-slide-in {
      animation: slideIn 0.4s ease-out forwards;
    }

    /* Utility classes */
    .delay-1 { animation-delay: 0.1s; opacity: 0; }
    .delay-2 { animation-delay: 0.2s; opacity: 0; }
    .delay-3 { animation-delay: 0.3s; opacity: 0; }
    .delay-4 { animation-delay: 0.4s; opacity: 0; }
    .delay-5 { animation-delay: 0.5s; opacity: 0; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    // ==================== DATA MODEL ====================
    const tmcData = {
      lastUpdated: "2026-01-19",
      systemStatus: {
        daysSinceChange: 4,
        monitoringActive: true
      },
      bindingConstraint: {
        id: "noaa-permit",
        name: "NOAA Domestic Permit",
        status: "pending",
        risk: "medium",
        lastChange: "2026-01-15",
        changeDescription: "Comment period extended"
      },
      nextMilestone: {
        name: "Comment Period Closes",
        date: "2026-02-12",
        type: "deadline",
        relevantGate: "noaa-permit"
      },
      gates: [
        {
          id: "noaa-permit",
          name: "NOAA Domestic Permit",
          shortName: "NOAA Permit",
          state: "pending",
          blocking: true,
          riskLevel: "medium",
          earliestPossible: "2026-02-12",
          nextKnownEvent: "Comment period closes Feb 12",
          lastChange: "2026-01-15",
          interpretation: "Core binding constraint. NOAA must approve deep-sea mining permit under DSHMRA. Comment period currently open with active opposition from environmental groups. Decision expected 30-60 days after comment period closes, assuming no litigation delays.",
          position: 0
        },
        {
          id: "eis-clearance",
          name: "Environmental Impact Statement",
          shortName: "EIS Clearance",
          state: "pending",
          blocking: false,
          riskLevel: "low",
          earliestPossible: "2026-03-01",
          nextKnownEvent: "Final EIS under review",
          lastChange: "2025-12-18",
          interpretation: "Final EIS submitted and under agency review. No material objections raised in preliminary assessment. This gate is dependent on NOAA permit process and will likely clear shortly after permit approval.",
          position: 1
        },
        {
          id: "litigation",
          name: "Litigation / Injunction Risk",
          shortName: "Litigation",
          state: "at-risk",
          blocking: false,
          riskLevel: "high",
          earliestPossible: "2026-02-18",
          nextKnownEvent: "Court hearing Feb 18 (CBD injunction motion)",
          lastChange: "2026-01-08",
          interpretation: "Center for Biological Diversity filed injunction motion Jan 8. Hearing scheduled Feb 18. Similar motions in this district denied ~60-70% historically, but current judge has mixed record on environmental cases. Risk concentrated in next 4-6 weeks.",
          position: 2
        },
        {
          id: "isa-regs",
          name: "ISA Exploitation Regulations",
          shortName: "ISA Regs",
          state: "inactive",
          blocking: false,
          riskLevel: "low",
          earliestPossible: "2027-Q2",
          nextKnownEvent: "ISA Council meeting July 2026",
          lastChange: "2025-11-30",
          interpretation: "International Seabed Authority exploitation code still in development. Currently non-binding for TMC's domestic operations under DSHMRA. Will become relevant only after domestic permits secured. Not a near-term constraint.",
          position: 3
        },
        {
          id: "commercial-start",
          name: "Commercial Operations",
          shortName: "Commercial",
          state: "inactive",
          blocking: false,
          riskLevel: "low",
          earliestPossible: "2027-H1",
          nextKnownEvent: "Dependent on prior gates",
          lastChange: null,
          interpretation: "Final gate representing commercial-scale nodule collection. Timing entirely dependent on resolution of upstream permits and litigation. Vessel and processing infrastructure preparation ongoing in parallel.",
          position: 4
        }
      ],
      riskModifiers: [
        {
          id: "dod-support",
          name: "DoD / Navy Support",
          targetGate: "noaa-permit",
          effect: "positive",
          strength: "medium",
          state: "active",
          interpretation: "DoD submitted supportive comment letter Jan 12 citing strategic mineral security. Historically, DoD support correlates with higher permit approval rates for strategic resources. Reduces political risk of denial."
        },
        {
          id: "political-pressure",
          name: "Political Alignment",
          targetGate: "noaa-permit",
          effect: "mixed",
          strength: "medium",
          state: "active",
          interpretation: "Current administration has mixed signals on deep-sea mining. Commerce Dept. favorable; EPA and some congressional members opposed. Net effect uncertain but not actively blocking."
        },
        {
          id: "ngo-opposition",
          name: "Environmental NGO Opposition",
          targetGate: "litigation",
          effect: "negative",
          strength: "high",
          state: "active",
          interpretation: "Coalition of 12 environmental groups actively opposing. CBD leading litigation effort. Greenpeace conducting public awareness campaign. Creates sustained pressure but legal standing for injunction is weak."
        }
      ],
      openRisks: [
        {
          id: "risk-1",
          title: "CBD Injunction Motion Pending",
          severity: "high",
          affectsGate: "litigation",
          gateIsBinding: false,
          description: "Motion for preliminary injunction filed Jan 8. If granted, would delay all permit activity until full trial.",
          nextAction: "Court hearing Feb 18"
        },
        {
          id: "risk-2",
          title: "Comment Period Open",
          severity: "medium",
          affectsGate: "noaa-permit",
          gateIsBinding: true,
          description: "Public comment period accepting submissions. High volume of opposition comments expected but legally non-determinative.",
          nextAction: "Closes Feb 12"
        },
        {
          id: "risk-3",
          title: "EPA Consultation Pending",
          severity: "low",
          affectsGate: "eis-clearance",
          gateIsBinding: false,
          description: "EPA requested additional consultation on certain EIS findings. Routine process, not expected to materially delay.",
          nextAction: "Response due Feb 28"
        }
      ],
      recentChanges: [
        {
          id: "change-1",
          date: "2026-01-15",
          type: "neutral",
          title: "Comment period extended 14 days",
          description: "NOAA extended comment period to Feb 12 following procedural request. Minor delay, no material impact on outcome probability.",
          affectsGate: "noaa-permit"
        },
        {
          id: "change-2",
          date: "2026-01-12",
          type: "positive",
          title: "DoD support letter filed",
          description: "Department of Defense submitted formal comment supporting permit approval, citing critical mineral supply chain security.",
          affectsGate: "noaa-permit"
        },
        {
          id: "change-3",
          date: "2026-01-08",
          type: "negative",
          title: "CBD files injunction motion",
          description: "Center for Biological Diversity filed motion for preliminary injunction in federal court. Hearing scheduled Feb 18.",
          affectsGate: "litigation"
        },
        {
          id: "change-4",
          date: "2025-12-18",
          type: "positive",
          title: "Final EIS submitted",
          description: "TMC submitted final Environmental Impact Statement to NOAA. Agency review initiated.",
          affectsGate: "eis-clearance"
        }
      ]
    };

    // ==================== UTILITY FUNCTIONS ====================
    const getStatusColor = (state) => {
      switch(state) {
        case 'approved': return 'var(--accent-green)';
        case 'pending': return 'var(--accent-yellow)';
        case 'at-risk': return 'var(--accent-red)';
        case 'denied': return 'var(--accent-red)';
        case 'delayed': return 'var(--accent-yellow)';
        case 'inactive': return 'var(--accent-gray)';
        default: return 'var(--accent-gray)';
      }
    };

    const getStatusBg = (state) => {
      switch(state) {
        case 'approved': return 'var(--accent-green-dim)';
        case 'pending': return 'var(--accent-yellow-dim)';
        case 'at-risk': return 'var(--accent-red-dim)';
        case 'denied': return 'var(--accent-red-dim)';
        case 'delayed': return 'var(--accent-yellow-dim)';
        case 'inactive': return 'var(--accent-gray-dim)';
        default: return 'var(--accent-gray-dim)';
      }
    };

    const getRiskColor = (level) => {
      switch(level) {
        case 'high': return 'var(--accent-red)';
        case 'medium': return 'var(--accent-yellow)';
        case 'low': return 'var(--accent-green)';
        default: return 'var(--accent-gray)';
      }
    };

    const getEffectColor = (effect) => {
      switch(effect) {
        case 'positive': return 'var(--accent-green)';
        case 'negative': return 'var(--accent-red)';
        case 'mixed': return 'var(--accent-yellow)';
        default: return 'var(--accent-gray)';
      }
    };

    const getChangeColor = (type) => {
      switch(type) {
        case 'positive': return 'var(--accent-green)';
        case 'negative': return 'var(--accent-red)';
        case 'neutral': return 'var(--accent-yellow)';
        default: return 'var(--accent-gray)';
      }
    };

    const formatDate = (dateStr) => {
      if (!dateStr) return 'TBD';
      const date = new Date(dateStr);
      return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
    };

    const getDaysUntil = (dateStr) => {
      const target = new Date(dateStr);
      const now = new Date();
      const diff = Math.ceil((target - now) / (1000 * 60 * 60 * 24));
      return diff;
    };

    // ==================== COMPONENTS ====================

    // Header Component
    const Header = () => (
      <header style={{
        padding: '24px 32px',
        borderBottom: '1px solid var(--border)',
        background: 'var(--bg-secondary)',
        position: 'sticky',
        top: 0,
        zIndex: 100
      }}>
        <div style={{ maxWidth: '1400px', margin: '0 auto', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
          <div>
            <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
              <div style={{
                width: '10px',
                height: '10px',
                borderRadius: '50%',
                background: 'var(--accent-green)',
                boxShadow: '0 0 10px var(--accent-green)'
              }} className="animate-pulse" />
              <h1 style={{
                fontFamily: 'var(--font-mono)',
                fontSize: '20px',
                fontWeight: 600,
                letterSpacing: '-0.5px'
              }}>
                TMC APPROVAL STATE MAP
              </h1>
            </div>
            <p style={{
              color: 'var(--text-muted)',
              fontSize: '13px',
              marginTop: '4px',
              fontFamily: 'var(--font-mono)'
            }}>
              Live regulatory intelligence • The Metals Company
            </p>
          </div>
          <div style={{
            display: 'flex',
            alignItems: 'center',
            gap: '24px',
            fontSize: '13px',
            color: 'var(--text-secondary)'
          }}>
            <div style={{ textAlign: 'right' }}>
              <div style={{ color: 'var(--text-muted)', fontFamily: 'var(--font-mono)', fontSize: '11px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>Last Updated</div>
              <div style={{ fontFamily: 'var(--font-mono)' }}>{formatDate(tmcData.lastUpdated)}</div>
            </div>
            <div style={{ width: '1px', height: '32px', background: 'var(--border)' }} />
            <div style={{ textAlign: 'right' }}>
              <div style={{ color: 'var(--text-muted)', fontFamily: 'var(--font-mono)', fontSize: '11px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>System Status</div>
              <div style={{ fontFamily: 'var(--font-mono)', color: 'var(--accent-green)' }}>● Monitoring Active</div>
            </div>
          </div>
        </div>
      </header>
    );

    // System Summary Component
    const SystemSummary = () => {
      const daysUntilMilestone = getDaysUntil(tmcData.nextMilestone.date);
      
      return (
        <div style={{
          display: 'grid',
          gridTemplateColumns: 'repeat(3, 1fr)',
          gap: '20px',
          marginBottom: '32px'
        }} className="animate-fade-in delay-1">
          {/* Binding Constraint */}
          <div style={{
            background: 'var(--bg-card)',
            border: '1px solid var(--border)',
            borderRadius: '12px',
            padding: '24px',
            borderLeft: `3px solid ${getStatusColor(tmcData.bindingConstraint.status)}`
          }}>
            <div style={{
              fontFamily: 'var(--font-mono)',
              fontSize: '11px',
              color: 'var(--text-muted)',
              textTransform: 'uppercase',
              letterSpacing: '1px',
              marginBottom: '12px'
            }}>
              Current Binding Constraint
            </div>
            <div style={{ fontSize: '18px', fontWeight: 600, marginBottom: '8px' }}>
              {tmcData.bindingConstraint.name}
            </div>
            <div style={{ display: 'flex', gap: '12px', alignItems: 'center', marginBottom: '12px' }}>
              <span style={{
                padding: '4px 10px',
                borderRadius: '4px',
                fontSize: '12px',
                fontFamily: 'var(--font-mono)',
                fontWeight: 500,
                background: getStatusBg(tmcData.bindingConstraint.status),
                color: getStatusColor(tmcData.bindingConstraint.status),
                textTransform: 'uppercase'
              }}>
                {tmcData.bindingConstraint.status}
              </span>
              <span style={{
                padding: '4px 10px',
                borderRadius: '4px',
                fontSize: '12px',
                fontFamily: 'var(--font-mono)',
                fontWeight: 500,
                background: 'var(--bg-tertiary)',
                color: getRiskColor(tmcData.bindingConstraint.risk)
              }}>
                Risk: {tmcData.bindingConstraint.risk}
              </span>
            </div>
            <div style={{ fontSize: '13px', color: 'var(--text-secondary)' }}>
              Last change: {formatDate(tmcData.bindingConstraint.lastChange)}
            </div>
          </div>

          {/* System Status */}
          <div style={{
            background: 'var(--bg-card)',
            border: '1px solid var(--border)',
            borderRadius: '12px',
            padding: '24px'
          }}>
            <div style={{
              fontFamily: 'var(--font-mono)',
              fontSize: '11px',
              color: 'var(--text-muted)',
              textTransform: 'uppercase',
              letterSpacing: '1px',
              marginBottom: '12px'
            }}>
              System Status
            </div>
            <div style={{ fontSize: '32px', fontWeight: 700, fontFamily: 'var(--font-mono)', marginBottom: '4px' }}>
              {tmcData.systemStatus.daysSinceChange}
            </div>
            <div style={{ fontSize: '14px', color: 'var(--text-secondary)', marginBottom: '16px' }}>
              days since material change
            </div>
            <div style={{
              padding: '12px',
              background: 'var(--bg-tertiary)',
              borderRadius: '8px',
              fontSize: '13px',
              color: 'var(--text-secondary)'
            }}>
              <span style={{ color: 'var(--accent-green)' }}>●</span> All systems nominal. Monitoring active.
            </div>
          </div>

          {/* Next Milestone */}
          <div style={{
            background: 'var(--bg-card)',
            border: '1px solid var(--border)',
            borderRadius: '12px',
            padding: '24px',
            borderLeft: '3px solid var(--accent-blue)'
          }}>
            <div style={{
              fontFamily: 'var(--font-mono)',
              fontSize: '11px',
              color: 'var(--text-muted)',
              textTransform: 'uppercase',
              letterSpacing: '1px',
              marginBottom: '12px'
            }}>
              Next Known Milestone
            </div>
            <div style={{ fontSize: '18px', fontWeight: 600, marginBottom: '8px' }}>
              {tmcData.nextMilestone.name}
            </div>
            <div style={{
              display: 'flex',
              alignItems: 'baseline',
              gap: '8px',
              marginBottom: '12px'
            }}>
              <span style={{
                fontSize: '28px',
                fontWeight: 700,
                fontFamily: 'var(--font-mono)',
                color: daysUntilMilestone <= 7 ? 'var(--accent-red)' : daysUntilMilestone <= 21 ? 'var(--accent-yellow)' : 'var(--accent-blue)'
              }}>
                {daysUntilMilestone}
              </span>
              <span style={{ fontSize: '14px', color: 'var(--text-secondary)' }}>days</span>
            </div>
            <div style={{ fontSize: '13px', color: 'var(--text-secondary)', fontFamily: 'var(--font-mono)' }}>
              {formatDate(tmcData.nextMilestone.date)}
            </div>
          </div>
        </div>
      );
    };

    // Gate Node Component
    const GateNode = ({ gate, isSelected, onClick, isLast }) => {
      const modifiers = tmcData.riskModifiers.filter(m => m.targetGate === gate.id);
      
      return (
        <div style={{ display: 'flex', alignItems: 'center' }}>
          <div
            onClick={() => onClick(gate)}
            style={{
              background: isSelected ? 'var(--bg-tertiary)' : 'var(--bg-card)',
              border: `2px solid ${isSelected ? getStatusColor(gate.state) : 'var(--border)'}`,
              borderRadius: '12px',
              padding: '16px 20px',
              minWidth: '160px',
              cursor: 'pointer',
              transition: 'all 0.2s ease',
              position: 'relative',
              opacity: gate.state === 'inactive' ? 0.6 : 1
            }}
          >
            {gate.blocking && (
              <div style={{
                position: 'absolute',
                top: '-8px',
                right: '-8px',
                background: 'var(--accent-red)',
                color: 'white',
                fontSize: '9px',
                fontFamily: 'var(--font-mono)',
                fontWeight: 600,
                padding: '2px 6px',
                borderRadius: '4px',
                textTransform: 'uppercase',
                letterSpacing: '0.5px'
              }}>
                Blocking
              </div>
            )}
            <div style={{
              width: '12px',
              height: '12px',
              borderRadius: '50%',
              background: getStatusColor(gate.state),
              marginBottom: '10px',
              boxShadow: gate.state !== 'inactive' ? `0 0 12px ${getStatusColor(gate.state)}` : 'none'
            }} />
            <div style={{
              fontFamily: 'var(--font-mono)',
              fontSize: '13px',
              fontWeight: 600,
              marginBottom: '6px'
            }}>
              {gate.shortName}
            </div>
            <div style={{
              display: 'flex',
              gap: '6px',
              flexWrap: 'wrap'
            }}>
              <span style={{
                padding: '2px 6px',
                borderRadius: '3px',
                fontSize: '10px',
                fontFamily: 'var(--font-mono)',
                background: getStatusBg(gate.state),
                color: getStatusColor(gate.state),
                textTransform: 'uppercase'
              }}>
                {gate.state}
              </span>
              {gate.state !== 'inactive' && (
                <span style={{
                  padding: '2px 6px',
                  borderRadius: '3px',
                  fontSize: '10px',
                  fontFamily: 'var(--font-mono)',
                  background: 'var(--bg-tertiary)',
                  color: getRiskColor(gate.riskLevel)
                }}>
                  {gate.riskLevel}
                </span>
              )}
            </div>
            
            {/* Risk Modifier Indicators */}
            {modifiers.length > 0 && (
              <div style={{
                position: 'absolute',
                bottom: '-24px',
                left: '50%',
                transform: 'translateX(-50%)',
                display: 'flex',
                gap: '4px'
              }}>
                {modifiers.map(m => (
                  <div
                    key={m.id}
                    style={{
                      width: '8px',
                      height: '8px',
                      borderRadius: '50%',
                      background: getEffectColor(m.effect),
                      border: '2px solid var(--bg-primary)'
                    }}
                    title={m.name}
                  />
                ))}
              </div>
            )}
          </div>
          
          {/* Connector Arrow */}
          {!isLast && (
            <div style={{
              display: 'flex',
              alignItems: 'center',
              padding: '0 8px'
            }}>
              <div style={{
                width: '40px',
                height: '2px',
                background: gate.state === 'approved' ? 'var(--accent-green)' : 'var(--border)',
                position: 'relative'
              }}>
                <div style={{
                  position: 'absolute',
                  right: '-4px',
                  top: '-4px',
                  width: 0,
                  height: 0,
                  borderTop: '5px solid transparent',
                  borderBottom: '5px solid transparent',
                  borderLeft: `8px solid ${gate.state === 'approved' ? 'var(--accent-green)' : 'var(--border)'}`
                }} />
              </div>
            </div>
          )}
        </div>
      );
    };

    // Approval Graph Component
    const ApprovalGraph = ({ selectedGate, onSelectGate }) => (
      <div style={{
        background: 'var(--bg-card)',
        border: '1px solid var(--border)',
        borderRadius: '12px',
        padding: '32px',
        marginBottom: '32px'
      }} className="animate-fade-in delay-2">
        <div style={{
          fontFamily: 'var(--font-mono)',
          fontSize: '11px',
          color: 'var(--text-muted)',
          textTransform: 'uppercase',
          letterSpacing: '1px',
          marginBottom: '24px'
        }}>
          Approval Critical Path
        </div>
        
        <div style={{
          display: 'flex',
          alignItems: 'flex-start',
          justifyContent: 'center',
          overflowX: 'auto',
          padding: '20px 0 40px 0'
        }}>
          {tmcData.gates.map((gate, idx) => (
            <GateNode
              key={gate.id}
              gate={gate}
              isSelected={selectedGate?.id === gate.id}
              onClick={onSelectGate}
              isLast={idx === tmcData.gates.length - 1}
            />
          ))}
        </div>

        {/* Risk Modifiers Legend */}
        <div style={{
          borderTop: '1px solid var(--border)',
          paddingTop: '20px',
          marginTop: '12px'
        }}>
          <div style={{
            fontFamily: 'var(--font-mono)',
            fontSize: '10px',
            color: 'var(--text-muted)',
            textTransform: 'uppercase',
            letterSpacing: '1px',
            marginBottom: '12px'
          }}>
            Active Risk Modifiers
          </div>
          <div style={{ display: 'flex', gap: '16px', flexWrap: 'wrap' }}>
            {tmcData.riskModifiers.map(mod => (
              <div
                key={mod.id}
                style={{
                  display: 'flex',
                  alignItems: 'center',
                  gap: '8px',
                  padding: '8px 12px',
                  background: 'var(--bg-tertiary)',
                  borderRadius: '6px',
                  fontSize: '12px'
                }}
              >
                <div style={{
                  width: '8px',
                  height: '8px',
                  borderRadius: '50%',
                  background: getEffectColor(mod.effect)
                }} />
                <span style={{ color: 'var(--text-secondary)' }}>{mod.name}</span>
                <span style={{
                  fontFamily: 'var(--font-mono)',
                  fontSize: '10px',
                  color: 'var(--text-muted)'
                }}>
                  → {tmcData.gates.find(g => g.id === mod.targetGate)?.shortName}
                </span>
              </div>
            ))}
          </div>
        </div>
      </div>
    );

    // Gate Detail Panel
    const GateDetailPanel = ({ gate, onClose }) => {
      if (!gate) return null;
      
      const modifiers = tmcData.riskModifiers.filter(m => m.targetGate === gate.id);
      const risks = tmcData.openRisks.filter(r => r.affectsGate === gate.id);
      
      return (
        <div style={{
          position: 'fixed',
          top: 0,
          right: 0,
          width: '480px',
          height: '100vh',
          background: 'var(--bg-secondary)',
          borderLeft: '1px solid var(--border)',
          padding: '32px',
          overflowY: 'auto',
          zIndex: 200
        }} className="animate-slide-in">
          <button
            onClick={onClose}
            style={{
              position: 'absolute',
              top: '24px',
              right: '24px',
              background: 'var(--bg-tertiary)',
              border: '1px solid var(--border)',
              borderRadius: '6px',
              padding: '8px 12px',
              color: 'var(--text-secondary)',
              cursor: 'pointer',
              fontFamily: 'var(--font-mono)',
              fontSize: '12px'
            }}
          >
            ✕ Close
          </button>
          
          <div style={{
            display: 'flex',
            alignItems: 'center',
            gap: '12px',
            marginBottom: '24px'
          }}>
            <div style={{
              width: '16px',
              height: '16px',
              borderRadius: '50%',
              background: getStatusColor(gate.state),
              boxShadow: `0 0 12px ${getStatusColor(gate.state)}`
            }} />
            <h2 style={{ fontSize: '20px', fontWeight: 600 }}>{gate.name}</h2>
          </div>
          
          <div style={{ display: 'flex', gap: '8px', marginBottom: '24px' }}>
            <span style={{
              padding: '6px 12px',
              borderRadius: '6px',
              fontSize: '13px',
              fontFamily: 'var(--font-mono)',
              fontWeight: 500,
              background: getStatusBg(gate.state),
              color: getStatusColor(gate.state),
              textTransform: 'uppercase'
            }}>
              {gate.state}
            </span>
            {gate.blocking && (
              <span style={{
                padding: '6px 12px',
                borderRadius: '6px',
                fontSize: '13px',
                fontFamily: 'var(--font-mono)',
                fontWeight: 500,
                background: 'var(--accent-red-dim)',
                color: 'var(--accent-red)',
                textTransform: 'uppercase'
              }}>
                Blocking
              </span>
            )}
            <span style={{
              padding: '6px 12px',
              borderRadius: '6px',
              fontSize: '13px',
              fontFamily: 'var(--font-mono)',
              fontWeight: 500,
              background: 'var(--bg-tertiary)',
              color: getRiskColor(gate.riskLevel)
            }}>
              Risk: {gate.riskLevel}
            </span>
          </div>
          
          {/* Interpretation */}
          <div style={{
            background: 'var(--bg-card)',
            border: '1px solid var(--border)',
            borderRadius: '8px',
            padding: '16px',
            marginBottom: '24px'
          }}>
            <div style={{
              fontFamily: 'var(--font-mono)',
              fontSize: '10px',
              color: 'var(--text-muted)',
              textTransform: 'uppercase',
              letterSpacing: '1px',
              marginBottom: '8px'
            }}>
              Analysis
            </div>
            <p style={{ fontSize: '14px', color: 'var(--text-secondary)', lineHeight: '1.7' }}>
              {gate.interpretation}
            </p>
          </div>
          
          {/* Timeline Info */}
          <div style={{
            display: 'grid',
            gridTemplateColumns: '1fr 1fr',
            gap: '12px',
            marginBottom: '24px'
          }}>
            <div style={{
              background: 'var(--bg-card)',
              border: '1px solid var(--border)',
              borderRadius: '8px',
              padding: '16px'
            }}>
              <div style={{
                fontFamily: 'var(--font-mono)',
                fontSize: '10px',
                color: 'var(--text-muted)',
                textTransform: 'uppercase',
                letterSpacing: '1px',
                marginBottom: '6px'
              }}>
                Earliest Possible
              </div>
              <div style={{ fontFamily: 'var(--font-mono)', fontSize: '14px' }}>
                {gate.earliestPossible}
              </div>
            </div>
            <div style={{
              background: 'var(--bg-card)',
              border: '1px solid var(--border)',
              borderRadius: '8px',
              padding: '16px'
            }}>
              <div style={{
                fontFamily: 'var(--font-mono)',
                fontSize: '10px',
                color: 'var(--text-muted)',
                textTransform: 'uppercase',
                letterSpacing: '1px',
                marginBottom: '6px'
              }}>
                Last Change
              </div>
              <div style={{ fontFamily: 'var(--font-mono)', fontSize: '14px' }}>
                {gate.lastChange ? formatDate(gate.lastChange) : 'N/A'}
              </div>
            </div>
          </div>
          
          {/* Next Known Event */}
          <div style={{
            background: 'var(--bg-card)',
            border: '1px solid var(--border)',
            borderLeft: '3px solid var(--accent-blue)',
            borderRadius: '8px',
            padding: '16px',
            marginBottom: '24px'
          }}>
            <div style={{
              fontFamily: 'var(--font-mono)',
              fontSize: '10px',
              color: 'var(--text-muted)',
              textTransform: 'uppercase',
              letterSpacing: '1px',
              marginBottom: '6px'
            }}>
              Next Known Event
            </div>
            <div style={{ fontSize: '14px' }}>
              {gate.nextKnownEvent}
            </div>
          </div>
          
          {/* Risk Modifiers */}
          {modifiers.length > 0 && (
            <div style={{ marginBottom: '24px' }}>
              <div style={{
                fontFamily: 'var(--font-mono)',
                fontSize: '10px',
                color: 'var(--text-muted)',
                textTransform: 'uppercase',
                letterSpacing: '1px',
                marginBottom: '12px'
              }}>
                Risk Modifiers ({modifiers.length})
              </div>
              {modifiers.map(mod => (
                <div
                  key={mod.id}
                  style={{
                    background: 'var(--bg-card)',
                    border: '1px solid var(--border)',
                    borderRadius: '8px',
                    padding: '16px',
                    marginBottom: '8px'
                  }}
                >
                  <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '8px' }}>
                    <div style={{
                      width: '10px',
                      height: '10px',
                      borderRadius: '50%',
                      background: getEffectColor(mod.effect)
                    }} />
                    <span style={{ fontWeight: 500 }}>{mod.name}</span>
                    <span style={{
                      padding: '2px 6px',
                      borderRadius: '3px',
                      fontSize: '10px',
                      fontFamily: 'var(--font-mono)',
                      background: 'var(--bg-tertiary)',
                      color: getEffectColor(mod.effect),
                      textTransform: 'uppercase'
                    }}>
                      {mod.effect}
                    </span>
                  </div>
                  <p style={{ fontSize: '13px', color: 'var(--text-secondary)', lineHeight: '1.6' }}>
                    {mod.interpretation}
                  </p>
                </div>
              ))}
            </div>
          )}
          
          {/* Open Risks */}
          {risks.length > 0 && (
            <div>
              <div style={{
                fontFamily: 'var(--font-mono)',
                fontSize: '10px',
                color: 'var(--text-muted)',
                textTransform: 'uppercase',
                letterSpacing: '1px',
                marginBottom: '12px'
              }}>
                Open Risks ({risks.length})
              </div>
              {risks.map(risk => (
                <div
                  key={risk.id}
                  style={{
                    background: 'var(--bg-card)',
                    border: '1px solid var(--border)',
                    borderLeft: `3px solid ${getRiskColor(risk.severity)}`,
                    borderRadius: '8px',
                    padding: '16px',
                    marginBottom: '8px'
                  }}
                >
                  <div style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', marginBottom: '8px' }}>
                    <span style={{ fontWeight: 500 }}>{risk.title}</span>
                    <span style={{
                      padding: '2px 6px',
                      borderRadius: '3px',
                      fontSize: '10px',
                      fontFamily: 'var(--font-mono)',
                      background: 'var(--bg-tertiary)',
                      color: getRiskColor(risk.severity),
                      textTransform: 'uppercase'
                    }}>
                      {risk.severity}
                    </span>
                  </div>
                  <p style={{ fontSize: '13px', color: 'var(--text-secondary)', marginBottom: '8px' }}>
                    {risk.description}
                  </p>
                  <div style={{
                    fontSize: '12px',
                    fontFamily: 'var(--font-mono)',
                    color: 'var(--accent-blue)'
                  }}>
                    → {risk.nextAction}
                  </div>
                </div>
              ))}
            </div>
          )}
        </div>
      );
    };

    // Open Risks Component
    const OpenRisks = () => (
      <div style={{
        background: 'var(--bg-card)',
        border: '1px solid var(--border)',
        borderRadius: '12px',
        padding: '24px',
        marginBottom: '32px'
      }} className="animate-fade-in delay-3">
        <div style={{
          fontFamily: 'var(--font-mono)',
          fontSize: '11px',
          color: 'var(--text-muted)',
          textTransform: 'uppercase',
          letterSpacing: '1px',
          marginBottom: '20px',
          display: 'flex',
          alignItems: 'center',
          gap: '8px'
        }}>
          <span style={{
            width: '8px',
            height: '8px',
            borderRadius: '50%',
            background: 'var(--accent-red)'
          }} />
          Open Risks ({tmcData.openRisks.length})
        </div>
        
        <div style={{ display: 'flex', flexDirection: 'column', gap: '12px' }}>
          {tmcData.openRisks.map(risk => {
            const gate = tmcData.gates.find(g => g.id === risk.affectsGate);
            return (
              <div
                key={risk.id}
                style={{
                  display: 'grid',
                  gridTemplateColumns: '1fr auto auto',
                  gap: '16px',
                  alignItems: 'center',
                  padding: '16px',
                  background: 'var(--bg-tertiary)',
                  borderRadius: '8px',
                  borderLeft: `3px solid ${getRiskColor(risk.severity)}`
                }}
              >
                <div>
                  <div style={{ fontWeight: 500, marginBottom: '4px' }}>{risk.title}</div>
                  <div style={{ fontSize: '13px', color: 'var(--text-secondary)' }}>{risk.description}</div>
                </div>
                <div style={{ textAlign: 'center' }}>
                  <div style={{
                    fontFamily: 'var(--font-mono)',
                    fontSize: '10px',
                    color: 'var(--text-muted)',
                    marginBottom: '4px'
                  }}>
                    AFFECTS
                  </div>
                  <div style={{
                    padding: '4px 8px',
                    background: 'var(--bg-card)',
                    borderRadius: '4px',
                    fontSize: '12px',
                    fontFamily: 'var(--font-mono)'
                  }}>
                    {gate?.shortName}
                    {risk.gateIsBinding && (
                      <span style={{ color: 'var(--accent-red)', marginLeft: '4px' }}>●</span>
                    )}
                  </div>
                </div>
                <div style={{ textAlign: 'right' }}>
                  <div style={{
                    fontFamily: 'var(--font-mono)',
                    fontSize: '10px',
                    color: 'var(--text-muted)',
                    marginBottom: '4px'
                  }}>
                    NEXT ACTION
                  </div>
                  <div style={{
                    fontSize: '12px',
                    fontFamily: 'var(--font-mono)',
                    color: 'var(--accent-blue)'
                  }}>
                    {risk.nextAction}
                  </div>
                </div>
              </div>
            );
          })}
        </div>
      </div>
    );

    // Recent Changes Component
    const RecentChanges = () => (
      <div style={{
        background: 'var(--bg-card)',
        border: '1px solid var(--border)',
        borderRadius: '12px',
        padding: '24px'
      }} className="animate-fade-in delay-4">
        <div style={{
          fontFamily: 'var(--font-mono)',
          fontSize: '11px',
          color: 'var(--text-muted)',
          textTransform: 'uppercase',
          letterSpacing: '1px',
          marginBottom: '20px'
        }}>
          Recent Material Changes (30 days)
        </div>
        
        <div style={{ display: 'flex', flexDirection: 'column', gap: '1px' }}>
          {tmcData.recentChanges.map((change, idx) => {
            const gate = tmcData.gates.find(g => g.id === change.affectsGate);
            return (
              <div
                key={change.id}
                style={{
                  display: 'grid',
                  gridTemplateColumns: '100px 1fr auto',
                  gap: '20px',
                  padding: '16px 0',
                  borderTop: idx === 0 ? 'none' : '1px solid var(--border)'
                }}
              >
                <div style={{
                  fontFamily: 'var(--font-mono)',
                  fontSize: '13px',
                  color: 'var(--text-muted)'
                }}>
                  {formatDate(change.date)}
                </div>
                <div>
                  <div style={{
                    display: 'flex',
                    alignItems: 'center',
                    gap: '8px',
                    marginBottom: '4px'
                  }}>
                    <div style={{
                      width: '8px',
                      height: '8px',
                      borderRadius: '50%',
                      background: getChangeColor(change.type)
                    }} />
                    <span style={{ fontWeight: 500 }}>{change.title}</span>
                  </div>
                  <div style={{ fontSize: '13px', color: 'var(--text-secondary)' }}>
                    {change.description}
                  </div>
                </div>
                <div style={{
                  padding: '4px 8px',
                  background: 'var(--bg-tertiary)',
                  borderRadius: '4px',
                  fontSize: '11px',
                  fontFamily: 'var(--font-mono)',
                  color: 'var(--text-muted)',
                  height: 'fit-content'
                }}>
                  {gate?.shortName}
                </div>
              </div>
            );
          })}
        </div>
      </div>
    );

    // Main App Component
    const App = () => {
      const [selectedGate, setSelectedGate] = useState(null);
      
      return (
        <div style={{ minHeight: '100vh', background: 'var(--bg-primary)' }}>
          <Header />
          
          <main style={{
            maxWidth: '1400px',
            margin: '0 auto',
            padding: '32px'
          }}>
            <SystemSummary />
            <ApprovalGraph 
              selectedGate={selectedGate}
              onSelectGate={setSelectedGate}
            />
            
            <div style={{
              display: 'grid',
              gridTemplateColumns: '1fr 1fr',
              gap: '24px'
            }}>
              <OpenRisks />
              <RecentChanges />
            </div>
          </main>
          
          {selectedGate && (
            <>
              <div
                style={{
                  position: 'fixed',
                  top: 0,
                  left: 0,
                  right: 0,
                  bottom: 0,
                  background: 'rgba(0,0,0,0.5)',
                  zIndex: 150
                }}
                onClick={() => setSelectedGate(null)}
              />
              <GateDetailPanel
                gate={selectedGate}
                onClose={() => setSelectedGate(null)}
              />
            </>
          )}
          
          {/* Footer */}
          <footer style={{
            borderTop: '1px solid var(--border)',
            padding: '24px 32px',
            marginTop: '48px'
          }}>
            <div style={{
              maxWidth: '1400px',
              margin: '0 auto',
              display: 'flex',
              justifyContent: 'space-between',
              alignItems: 'center',
              fontSize: '12px',
              color: 'var(--text-muted)',
              fontFamily: 'var(--font-mono)'
            }}>
              <div>
                TMC Approval State Map • For informational purposes only • Not financial advice
              </div>
              <div>
                Data manually curated • Last verified: {formatDate(tmcData.lastUpdated)}
              </div>
            </div>
          </footer>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
